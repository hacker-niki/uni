<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html><head>
   <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
   <meta name="GENERATOR" content="Mozilla/4.75 [en] (WinNT; U) [Netscape]">
   <title>FEM Introduction</title>
<style>
body {margin-left: 5%; margin-right: 5%; background-color:#FFFFFF}
p    {margin-top: 5pt; margin-bottom: 0pt; text-indent: 1cm; text-align: justify}
p.h    {font-weight: bold}
ul.no {list-style-type: none}
</style>
</head>
<body>

<center>
<h3>
Московский Государственный Технический Университет</h3></center>

<center>
<h4>
имени Н.Э.Баумана</h4></center>

<center>
<h2>
Кафедра САПР</h2></center>

<hr width="100%">
<div align="right">
<h3>
<nobr>Трудоношин В. А.</nobr>, <nobr>Уваров М. Ю.</nobr></h3></div>

<div align="right">
<h4>
rk6trud@wwwcdl.bmstu.ru</h4></div>

<div align="right">
<h5>
<nobr>(095) 263-65-26</nobr></h5></div>

<center>
<h1>
Введение в метод конечных элементов</h1></center>
Метод конечных элементов (МКЭ) является сеточным методом, предназначенным
для решения задач микроуровня, для которого модель объекта задаётся системой
дифференциальных уравнений в частных производных с заданными краевыми условиями.
<center>
<h2>
1. Метод взвешенных невязок</h2></center>
МКЭ основывается на методе взвешенных невязок, суть которого заключается
в следующем: подбирается функция, удовлетворяющая дифференциальным уравнениям
и краевым условиям, но подбирается не произвольно, поскольку такой подбор
вряд ли возможен уже в двумерном пространстве, а с использованием специальных
методов.
<p>Пусть состояние некоторой среды описывается следующим дифференциальным
оператором, с заданным граничным условием:
</p><center><i>LV + P = 0</i>
<br><i>V(Г) = V<sub>г</sub></i></center>

<blockquote>Здесь <i>L</i> – дифференциальный оператор (например оператор
Лапласа),
<br><i>V</i> – фазовая переменная – неизвестная функция, которую следует
найти,
<br><i>P</i> – величина, независящая от <i>V</i>,
<br><i>V(Г) = V</i><sub>г</sub> – граничное условие первого рода (Дирихле),
то есть на границе задано значение фазовой переменной. (Решение задачи
с граничными условиями Неймана будет рассмотрено ниже).</blockquote>
Будем искать решение с помощью функции, имеющей следующий вид:
<center><img src="mke_files/f01.gif" height="55" width="251"></center>

<blockquote>Здесь <i>V<sup>*</sup></i> – приближённое решение,
<br><i>F</i> – функция, удовлетворяющая граничным условиям,
<br><i>N</i><sub>m</sub> – пробные функции, которые на границе области
должны быть равны нулю,
<br><i>A</i><sub>m</sub> – неизвестные коэффициенты, которые необходимо
отыскать из условия наилучшего удовлетворения дифференциальному оператору,
<br><i>M</i> – количество пробных функций.</blockquote>
Если подставить <i>V</i><sup>*</sup> в исходный дифференциальный оператор,
то получим невязку, принимающую в различных точках области разное значение.
<center><i>R = LV<sup>*</sup> + P</i></center>

<p>Необходимо сформулировать условие, позволяющее минимизировать эту невязку
по всей области. Одним из вариантов такого условия может быть следующее
уравнение:
</p><center><img src="mke_files/f02.gif" height="45" width="107"></center>

<blockquote>Здесь <i>W<sub>n</sub></i> – некоторые весовые функции, в зависимости
от выбора которых различают варианты метода взвешенных невязок,
<br><i>S</i> – область пространства, в которой ищется решение.</blockquote>
При выборе в качестве весовых функций дельта-фукций будем иметь метод,
который получил название метод поточечной коллокации, для кусочно-постоянных
функций – метод коллокации по подобластям, но наиболее распространенным
является метод Галёркина, в котором в качестве весовых функций выбираются
пробные функции <i>N</i>. В этом случае, если количество пробных функций
равно количеству весовых функций, после раскрытия определенных интегралов
приходим к замкнутой системе алгебраических уравнений относительно коэффициентов
<i>A</i>.
<center><i>KA + Q = 0</i></center>

<p>где коэффициенты матрицы K и вектора Q вычисляются по формулам:
</p><center><img src="mke_files/f03.gif" height="48" width="138">
<br><img src="mke_files/f04.gif" height="46" width="186"></center>

<p>После нахождения коэффициентов <i>A</i> и подстановки их в (1), получаем
решение исходной задачи.
</p><p>Недостатки метода взвешенных невязок очевидны: поскольку решение ищется
сразу по всей области, то количество пробных и весовых функций должно быть
значительным для обеспечения приемлемой точности, но при этом возникают
трудности при вычислении коэффициентов <i>K<sub>ij</sub></i> и <i>Q<sub>i</sub></i>,
особенно при решении плоских и объемных задач, когда потребуется вычисление
двойных и тройных интегралов по областям с криволинейными границами. Поэтому
на практике этот метод не использовался, пока не был изобретен метод конечных
элементов (МКЭ).
</p><center>
<h2>
2. Метод конечных элементов</h2></center>
Идея метода заключается в следующем: в методе взвешенных невязок воспользоваться
простыми пробными и весовыми функциями, но не во всей области <i>S</i>,
а в её отдельных подобластях (конечных элементах), а точность решения задачи
обеспечить использованием большого числа конечных элементов (КЭ), при этом
КЭ могут быть простой формы и вычисление интегралов по ним не должно вызывать
особых затруднений. Математически переход от метода взвешенных невязок
к МКЭ осуществляется с использованием специальных пробных функций, которые
также называются глобальными базисными функциями, обладающих следующими
свойствами:
<p>1) в узле аппроксимации функции имеют значение равное единице;
</p><p>2) отличны от нуля только в КЭ, содержащих этот узел аппроксимации,
во всей остальной области равны нулю.
</p><ol type="1"><lh>Этапы решения задач с общих позиций:

<p class="h">Выбор конечного элемента.
</p><p>В одномерной задаче это просто отрезок прямой. В двумерной задаче –
треугольный (симплекс) элемент, четырёхугольный элемент, в общем случае
любая фигура, с помощью которой можно разбить исследуемую область на непересекающиеся
подобласти, но при этом следует учитывать, что чем сложнее элемент, тем
с большими сложностями придётся столкнуться при вычислении интегралов,
поэтому наиболее распространенными являются треугольный элемент и четырёхугольный
со сторонами паралельными осям координат. Для трёхмерной области – тетраэдр
и параллелепипед.

</p><p class="h">Разбиение области на КЭ.
</p><p>В отличие от метода конечных разностей разбиение может быть неравномерным
и априорно учитывать градиент фазовой переменной, то есть там гдe предполагается
быстрое изменение фазовой переменной сетка должна быть гуще и наоборот.
Существуют различные способы автоматического разбиения области на конечные
элементы, поскольку исполнение этого этапа вручную утомительно и часто
приводит к ошибкам.

</p><p class="h">Получение функции формы.
</p><p>В зависимости от соотношения требований точности задачи и возможностей
вычислительной системы выбирают линейную, квадратичную или более высокую
степень функции формы, при этом число узлов аппроксимации должно быть минимум
на единицу больше порядка аппроксимирующей функции.

</p><p class="h">Получение матрицы жёсткости и вектора нагрузок.
</p><p>Этот этап получил своё название из строительной механики, поскольку
именно там впервые был применён МКЭ. На этом этапе используется метод взвешенных
невязок в пределах одного КЭ.

</p><p class="h">Ансамблирование или получение глобальных матрицы жёсткости
и вектора нагрузок.

</p><p class="h">Учёт граничных условий.

</p><p class="h">Решение системы алгебраических уравнений.
</p><p>При решении может быть учтена особенность матрицы коэффициентов, поскольку
она, как правило, имеет ленточную форму.</p></lh></ol>

<center>
<h3>
2.1. Решение задач в одномерной области</h3></center>
Для одномерной задачи набор кусочно-линейных функций, при количестве КЭ,
равном трём, иллюстрируется следующим рисунком:
<center><img src="mke_files/i01.GIF" height="256" width="293"></center>

<p>В результате на каждом КЭ действует строго определенное число ненулевых
глобальных базисных функций (в данном примере две) и вместо вычисления
интеграла по всей области можно вычислить интегралы по КЭ и сложить их.
Процедура сложения получила название ансамблирование. Использование глобальных
базисных функций приводит к тому, что процедура вычисления интегралов по
КЭ становится достаточно простой и, поскольку в узлах аппроксимации <i>N<sub>m</sub>
= 1</i>, коэффициенты <i>A</i> приобретают физический смысл, они становятся
равными значению фазовой переменной в узлах. В аппроксимации (1) теперь
можно отказаться от использования функции <i>F</i>, поскольку удовлетворить
граничные условия можно естественным образом, задавая значения <i>V</i>
в узлах, расположенных на границе.
</p><p>В пределах одного КЭ, при условии, что он включен между <i>i</i>-м и
<i>j</i>-м
узлами, аппроксимацию решения можно определить с помощью глобальных базисных
функций следующим образом:
</p><center><i>V = (1 - x/L)V<sub>i</sub> + x/L V<sub>j</sub> = N<sub>e</sub>V</i></center>

<blockquote>Здесь <i>x</i> – текущая координата, отсчитываемая от начала
КЭ,
<br><i>L</i> – его длина,
<br><i>V<sub>i</sub></i> и <i>V<sub>j</sub></i> – значения фазовых переменных
в узлах КЭ.</blockquote>
Компоненты вектора <i>N<sub>e</sub></i> получили название функций формы
конечного элемента. Функции формы можно получить и из других соображений.
Зададимся полиномом, аппроксимирующим решение внутри конечного элемента,
например:
<center>
<p><i>V = A<sub>0</sub> + A<sub>1</sub> x.</i></p></center>

<p>при <i>x = 0&nbsp; V<sub>i</sub> = A<sub>0</sub></i>, при <i>x = L&nbsp;
V<sub>j</sub> = A<sub>0</sub> + A<sub>1</sub>L,</i>
</p><p>Находим коэффициенты <i>A<sub>0</sub></i> и <i>A<sub>1</sub></i> и подставляем
их в аппроксимацию
</p><center>
<p><i>V = V<sub>i</sub> + (V<sub>j</sub> - V<sub>i</sub>)x/L = (1 - x/L)V<sub>i</sub>
+ x/L V<sub>j</sub></i></p></center>

<p>Таким же образом можно получить функции формы для квадратичный, кубической
и других аппроксимаций. Соответственно аппроксимации называются и функции
формы и КЭ – квадратичный, кубический и т.д.
<br>&nbsp;&nbsp;&nbsp;&nbsp; Например получение квадратичной функции формы
выглядит следующим образом. При этом, естественно, в пределах конечного
элемента должно использоваться три узла аппроксимации, один из которых
является внутренним для КЭ. При расположении внутреннего узла в середине
КЭ (что необязательно) полином, аппроксимирующий решение внутри конечного
элемента, будет иметь вид:
</p><center>
<p><i>Y = A<sub>0</sub> + A<sub>1</sub>x + A<sub>2</sub>x<sup>2</sup>.</i></p></center>

<p>при <i>x = 0&nbsp; Y<sub>i</sub> = A<sub>0</sub></i>,
</p><p>при <i>x = L/2&nbsp; Y<sub>j</sub> = A<sub>0</sub> + A<sub>1</sub>L/2
+ A<sub>2</sub>L<sup>2</sup>/4</i>,
</p><p>при <i>x = L&nbsp; Y<sub>k</sub> = A<sub>0</sub> + A<sub>1</sub>L +
A<sub>2</sub>L<sup>2</sup></i>.
</p><p>Решая эту систему относительно коэффициентов <i>A<sub>0</sub></i>, <i>A<sub>1</sub></i>
и <i>A<sub>2</sub></i>, получим:
</p><p><i>A<sub>0</sub> = Y<sub>i</sub>,</i>
</p><p><i>A<sub>1</sub> = (4Y<sub>j</sub> - 3Y<sub>i</sub> - Y<sub>k</sub>)/L,</i>
</p><p><i>A<sub>2</sub> = (2Y<sub>k</sub> - 4Y<sub>j</sub> + 2Y<sub>i</sub>)/L<sup>2</sup>.</i>
</p><p>Подставляем их в аппроксимацию и приводим подобные относительно <i>Y<sub>i</sub></i>,
<i>Y<sub>j</sub></i>
и <i>Y<sub>k</sub></i>:
</p><center>
<p><i>Y = Y<sub>i</sub> + (4Y<sub>j</sub> - 3Y<sub>i</sub> - Y<sub>k</sub>)x/L
+ (2Y<sub>k</sub> - 4Y<sub>j</sub> + 2Y<sub>i</sub>)x<sup> 2</sup>/L<sup>
2</sup> =</i>
</p><p><i>(1 - 3x/L + 2x<sup> 2</sup>/L<sup> 2</sup>)Y<sub>i</sub> + (4x/L
- 4x<sup> 2</sup>/L<sup> 2</sup>)Y<sub>j</sub> + (-x/L + 2x<sup> 2</sup>/L<sup>
2</sup>)Y<sub>k</sub>,</i></p></center>

<p>или в матричной форме:
</p><center><img src="mke_files/f06.gif" height="91" width="483"></center>

<p><br>
<br>
<br>
<br>
</p><p>Рассмотрим применение МКЭ для решения задачи о поперечном нагружении
балки с защемленным концом (см рисунок).
</p><center><img src="mke_files/i02.GIF" height="82" width="297">
<br><img src="mke_files/f05.GIF" height="51" width="116"></center>

<p>В уравнении:
<i>Y</i> – прогиб балки,
<i>M</i> – момент силы,
<i>E</i>
– модуль Юнга,
<i>I</i> – момент инерции сечения.

</p><p class="h">Этап 1. Выбор конечного элемента.
</p><p>В нашей задаче это просто отрезок прямой.

</p><p class="h">Этап 2. Разбиение области на КЭ.
</p><p>Выбираем равномерное разбиение на 3 конечных элемента.

</p><p class="h">Этап 3. Получение функции формы.
</p><p>Воспользуемся линейной функцией формы.

</p><p class="h">Этап 4. Получение матрицы жёсткости и вектора нагрузок.
</p><p>Согласно методу Галеркина необходимо вычислить определенный интеграл:
</p><center><img src="mke_files/f07.gif" height="60" width="171"></center>

<p>где <i>L</i> – длина КЭ.
</p><p>Для Y должно быть использовано аппроксимирующее выражение с использованием
функций формы. Но здесь следует обратить внимание на соотвествие порядка
аппроксимирующего полинома и порядка исходного дифференциального уравнения.
Порядок аппроксимирующего полинома должен быть больше или равен порядку
дифференциального уравнения, чтобы существовала старшая производная, но
существует способ понизить требование к гладкости аппроксимирующего полинома
раскрыв интеграл по частям:
</p><center><img src="mke_files/f08.GIF" height="64" width="336"></center>

<p>Проделав необходимые преобразования получим следующую математическую
модель КЭ:
</p><center><img src="mke_files/f09.gif" height="114" width="428"></center>

<p>Раскрытие интеграла по частям привело ещё к одному замечательному результату
– в математической модели элемента появились производные фазовой переменной
на границах элемента, это позволит в дальнейшем учесть граничные условия
второго рода (типа Неймана).

</p><p class="h">Этап 5. Ансамблирование или получение глобальных матрицы жёсткости
и вектора нагрузок.
</p><p>Вектор неизвестных составляют прогибы в узлах, то есть матрица коэффициентов
будет иметь четвёртый порядок. Рассматривая поочередно каждый КЭ, располагаем
элементы локальной матрицы жёсткости в глобальной в соотвествии с номерами
узлов подключения КЭ. Проделать эту процедуру можно с помощью приведённого
ниже апплета. Задать нумерацию узлов можно последовательно нажимая круглые
кнопки, при этом последний узел нумеруется автоматически. Получить аддитивный
вклад от отдельного КЭ в глобальную матрицу жёсткости можно с помощью кнопок,
расположенных над КЭ. Повторять нумерацию и получение аддитивного вклада
можно многократно, пользуясь кнопкой <b>Reset</b> и кнопками, расположенными
над конечными элементами. После ансамблирования получаем математическую
модель объекта.
</p><center>
<p><applet archive="mke_files/mkeclass.jar" code="MKEMatrix.class" height="320" width="620"><param name="code" value="MKEMatrix.class"><param name="width" value="620"><param name="height" value="320"></applet></p></center>


<p class="h">Этап 6. Учёт граничных условий.
</p><p>Количество неизвестных в полной математической модели равно шести при
четырех уравнениях, но учитывая, что <i>Y(0) = 0</i> и первая производная
в нулевом узле также равна нулю, получаем замкнутую систему уравнений.

</p><p class="h">Этап 7. Решение системы алгебраических уравнений.
</p><p>Используя представленный ниже апплет вы можете проверить свои ручные
расчеты при изучении МКЭ, а также получить изгибную линию балки при сложной
нагрузке.
</p><center>
<p><applet archive="mke_files/mkeclass.jar" code="Balka.class" height="320" width="600"><param name="code" value="Balka.class"><param name="width" value="600"><param name="height" value="320"></applet></p></center>

<ul><lh>В качестве исходных параметров можно задать:
<li>
<b>Number FE</b> – число КЭ, выбираемых из меню, в том числе можно задать
разбиение при помощи мыши в режиме 'Manual';</li>

<li>
<b>Diameter</b> – диаметр балки (в миллиметрах), по нему расчитывается
момент инерции сечения;</li>

<li>
<b>M<sub>max</sub></b> – максимальный по модулю момент силы (в килоньютонах
на метр), прилагаемый к балке, ему на графике соответствуют крайние по
высоте светлые линии;</li>

<li>
<b>Length</b> – длина балки (в метрах);</li>

<li>
<b>Young's modulus</b> – модуль Юнга (в гигапаскалях);</li>

<li>
<b>F<sub>max</sub></b> – максимальное значение силы по модулю (в килоньютонах),
ему на графике соотвествуют крайние по высоте светлые линии.</li>
</lh></ul>

<ul><lh>Режимы работы с апплетом задаются кнопками, расположенными под
рисунком:
<li>
кнопка <b>Diskret</b> – позволяет разбить балку на КЭ, как автоматически,
так и с помощью мыши;</li>

<li>
кнопка <b>Set/Reset M</b> – позволяет задать момент силы, воздействующий
на балку с помощью мыши, в пределах светлых линий;</li>

<li>
кнопка <b>Set/Reset F</b> – позволяет задавать силы, воздействующие на
балку, в пределах светлых линий;</li>

<li>
с помощью кнопок <b>Clear</b> производится очистка соответствующих значений;</li>

<li>
с помощью кнопки <b>Show result</b> можно обновить результаты расчета при
изменении параметров балки, во всех остальных случаях результат обновляется
автоматически, при этом справа от рисунка показывается максимальный прогиб
балки.</li>
</lh></ul>

<center>
<h3>
2.2. Решение задач в двумерной области</h3></center>
Рассмотрим некоторые этапы&nbsp; МКЭ для решения задачи о распределении
поля температур в однородной прямоугольной пластине с заданными граничными
условиями:

<p class="h">Этап 1. Выбор конечного элемента.
</p><p>Выбираем треугольный вид конечного элемента.

</p><p class="h">Этап 2. Разбиение области на КЭ.
</p><p>Исходную область разобъём следующим образом:
</p><center><img src="mke_files/i04.gif" height="243" width="374"></center>


<p class="h">Этап 3. Получение функции формы.
</p><p>Воспользуемся линейной аппроксимацией, тогда искомая функция будет представлена
в виде:
</p><center>
<p><i>T = A<sub>0</sub> + A<sub>1</sub>x + A<sub>2</sub>y.</i></p></center>
Исходя из условия, что значения фазовой переменной в узлах i,j,k конечного
элемента равны, соответственно&nbsp;<img src="mke_files/Image2.gif" height="25" width="57">,
можем записать систему линейных алгебраических уравнений
<center>
<p><img src="mke_files/Image3.gif" height="74" width="164">,</p></center>

<p>решая которую находим значения коэффициентов А, которые подставляем
в исходную аппроксимацию и приводим подобные члены при соответствующих
Т.
</p><div class="h"><p><b>Этап 4. </b>Получение матрицы жёсткости и вектора
нагрузок.</p></div>

<p>Согласно методу Галеркина необходимо вычислить определенный интеграл:
</p><center><img src="mke_files/f11.gif" height="57" width="207"></center>

<br>&nbsp;
<br>

<p class="h">Этап 5. Ансамблирование или получение глобальных матрицы жёсткости
и вектора нагрузок.
</p><p>В предположении, что математическая модель конечного элемента выглядит
следующим образом:
</p><center>
<p><img src="mke_files/Image4.gif" height="74" width="189"></p></center>

<p>в следующем апплете можно пронаблюдать как происходит процедура ансамблирования.
Из методических соображений ограничимся двумя смежными конечными элементами,
узлы которых обозначим буквами A, B, C и D. Используя выпадающие списки
апплета этим узлам можно сопоставить номера от в диапазоне 0 до 9. Задействуя
отображение 1-го (с узлами A, B и D) и 2-го (с узлами B, C и D) конечных
элементов с помощью соответствующих элементов апплета можно получить демонстрацию
аддитивного вклада каждого из конечных элементов. При нажатии кнопки <b>Reset</b>
апплет возвращается в исходное состояние и процедуру можно повторить для
другого порядка нумерации КЭ.
</p><center>
<p><applet archive="mke_files/mkeclass.jar" code="MKE2d.class" height="471" width="600"></applet></p></center>

<hr>


</body></html>